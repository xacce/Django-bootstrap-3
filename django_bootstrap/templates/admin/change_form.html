{% extends "admin/base_site.html" %}
{% load i18n admin_static admin_modify %}
{% load url from future %}
{% load admin_urls %}

{% block extrahead %}
    {{ block.super }}
    {% url 'admin:jsi18n' as jsi18nurl %}
    <script type="text/javascript" src="{{ jsi18nurl|default:"../../../jsi18n/" }}"></script>
    {{ media }}
{% endblock %}

{% block extrastyle %}{{ block.super }}{% endblock %}

{% block coltype %}{% if ordered_objects %}colMS{% else %}colM{% endif %}{% endblock %}

{% block bodyclass %}{{ opts.app_label }}-{{ opts.object_name.lower }} change-form{% endblock %}

{% if not is_popup %}
    {% block breadcrumbs %}
        <ul class="breadcrumb  col-lg-12">
            <li><a href="{% url 'admin:index' %}">{% trans 'Home' %}</a></li>
            <li><a href="{% url 'admin:app_list' app_label=opts.app_label %}">{{ app_label|capfirst|escape }}</a></li>
            {% if has_change_permission %}
                <li><a href="{% url opts|admin_urlname:'changelist' %}">{{ opts.verbose_name_plural|capfirst }}</a></li>{% else %}
                <li class="active">{{ opts.verbose_name_plural|capfirst }}</li>{% endif %}
            {% if add %}
                <li class="active">{% trans 'Add' %} {{ opts.verbose_name }}</li>{% else %}
                <li class="active">{{ original|truncatewords:"18" }}</li>{% endif %}
        </ul>
    {% endblock %}
{% endif %}

{% block content_title %}
    <div class="row">

        {% if change and not is_popup %}
            {% block object-tools-items %}
                <div class="col-lg-12" style="text-align: right">
                    <a href="history/" class="btn btn-default btn-small"><i class="glyphicon glyphicon-list"></i> {% trans "History" %} </a>
                    {% if has_absolute_url %}
                        <a href="../../../r/{{ content_type_id }}/{{ object_id }}/" class="btn btn-default btn-small">
                            <i class="glyphicon glyphicon-eye-open"></i> {% trans "View on site" %}</a></li>
                    {% endif %}
                </div>
            {% endblock %}
        {% endif %}
    </div>
    <br/>
{% endblock %}

{% block content %}
    <div id="content-main">

        <form class="form-horizontal" {% if has_file_field %}enctype="multipart/form-data" {% endif %}action="{{ form_url }}" method="post" id="{{ opts.module_name }}_form">{% csrf_token %}{% block form_top %}{% endblock %}
            <div>
                {% if is_popup %}<input type="hidden" name="_popup" value="1"/>{% endif %}
                {% if save_on_top %}{% block submit_buttons_top %}{% submit_row %}{% endblock %}{% endif %}
                {% if errors %}
                    {#                    <p class="errornote">#}
                    {#                        {% blocktrans count counter=errors|length %}Please correct the error below.{% plural %}Please correct the errors below.{% endblocktrans %}#}
                    {#                    </p>#}
                    {{ adminform.form.non_field_errors }}
                {% endif %}


                {% block field_sets %}
                    {% for fieldset in adminform %}
                        <div class="tab-content">
                            {% include "admin/includes/fieldset.html" %}
                        </div>

                    {% endfor %}
                {% endblock %}

                {% block after_field_sets %}{% endblock %}

                {% block inline_field_sets %}
                    {% for inline_admin_formset in inline_admin_formsets %}
                        {% if not inline_admin_formset.opts.out_form %}
                            {% include inline_admin_formset.opts.template %}
                        {% endif %}
                    {% endfor %}
                {% endblock %}

                {% block after_related_objects %}{% endblock %}

                {% block submit_buttons_bottom %}{% submit_row %}{% endblock %}

                {% if adminform and add %}
                    <script type="text/javascript">document.getElementById("{{ adminform.first_field.id_for_label }}").focus();</script>
                {% endif %}

                {# JavaScript for prepopulated fields #}
                {% prepopulated_fields_js %}

            </div>
        </form>

    </div>
    {% block admin_form_widgets %}
        {% for widget in widgets %}
            {{ widget.html }}
        {% endfor %}
    {% endblock %}
{% endblock %}
